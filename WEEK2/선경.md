-----

Chapter03. 트랜스포트 계층

-----

#### 트랜스 포트 계층
논리적 안정과 균일한 데이터 전송 서비스를 제공함으로써  
서로 다른 애플리케이션 프로세스들간에 신뢰성 있는 데이터 전송을 가능하게 함
**수신지 컴퓨터까지 신뢰할 수 있는 데이터를 전송하기 위해 필요한 계층**

트랜스포트 프로토콜은 종단 시스템에서 동작함  
* 송신측 :  
  메시지를 세그먼트들로 나누어 네트워크 계층으로 넘겨줌  
* 수신측 :  
  세그먼트들을 메시지로 재결합하여 응용계층으로 넘겨줌  

트랜스 포트 계층의 프로토콜에는 **TCP**와 **UDP**가 있음
트랜스 포트 계층의 패킷은 세그먼트 라고 함

관련 장비로는 게이트웨이가 있음

#### TCP
신뢰적이고 연결지향형 서비스를 제공함  
패킷에 대한 오류처리나 재전송따위로 에러를 복구하는 일을 하기 때문에  
TCP의 헤더에는 정보가 많이 있음  
3-way handshaking 과정을 통해 연결을 설정, 4-way handshaking을 통해 해제함  


#### UDP
비신뢰적이고 비연결형인 서비스를 제공함
트랜스포트 계층 프로토콜이 할 수 있는 최소 기능으로 동작함  
(다중화/역다중화 기능, 간단한 오류 검사 기능)  
패킷을 잃거나 오류가 있어도 대처하지 않기 때문에 UDP헤더는 간단한 구조를 갖고 있음  
신뢰성이 필요한 서비스보다 성능이 중요시 되는 경우에 사용함 (주로 실시간 서비스)

* checksum :  
  세그먼트가 출발지로부터 목적지로 이동 했을 때, UDP 세그먼트 안의 비트에 대한  
  변경사항이 있는지 검사함  
  사용하는 방법은 송신 측에서 모든 16비트 워드 단위로 더하고 이에 대하여 1의 보수를 수행함  
  이때 덧셈 과정에서 발생하는 오버플로는 윤회식 자리 올림을 함


#### 다중화와 역다중화
호스트-호스트 전달을 프로세스-프로세스 전달로 확장하는 것을 다중화와 역다중화라고 부름
* 다중화 :  
  출발지 호스트에서 소켓으로부터 데이터를 모으고 이에 대한 세그먼트를 생성하기 위해  
  데이터에 헤더를 붙여 캡슐화하고 이 세그먼트를 네트워크 계층으로 보내는 것
* 역다중화 :  
  트랜스포트 계층 세그먼트의 데이터를 올바른 소켓으로 전달하는 작업  

* 비연결형 다중화와 역다중화 :  
  두 개의 UDP 세그먼트들이 출발지 IP 주소와 줄발지 포트 번호가 모두 다르거나,  
  어느 한 가지만 다를지라도 동일한 목적지 IP 주소화 목적지 포트 번호를 가지면,  
  두 세그먼트들은 같은 목적지 소켓을 갖는 동일한 프로세스로 향하게 됨  
* 연결지향형 다중화와 역다중화 :  
  TCP 소켓은 출발지 IP 주소, 출발지 포트 번호, 목적지 IP 주소, 목적지 포트 번호에 의해 식별됨  
  호스트로 TCP 세그먼트가 도착하면, 호스트는 역다중화 하기 위해  
  위의 네 값을 모두 사용함  
  UDP와는 다르게, 다른 출발지 주소 또는 다른 출발지 포트 번호를 가지고  
  도착하는 두 개의 TCP 세그먼트는 두 개의 다른 소켓으로 향하게 됨.


#### 신뢰적인 데이터 전송
처음에는 간단한 모델로 시작해서 오류를 처리하기 위해 점점 복잡해지는 모델
신뢰적인 채널에서는 전송된 데이터가 손상되거나 손실되지 않음  
또한, 모든 데이터는 전송된 순서대로 전달됨
재전송을 기반으로 하는 신뢰적인 데이터 전송 프로토콜은 자동 재전송 요구 프로토콜(Automatic Repeat reQuest, ARQ)로 알려져 있음  
또한 비트 오류를 처리하기 위해 오류 검출, 수신자 피드백, 재전송의 세 가지 부가 기능들이 필요함
패킷에 순서 번호(sequence number)를 추가함으로써 해당 패킷이 재전송 패킷인지 아닌지를 판단할 수 있음


#### 혼잡 제어
네트워크의 처리 속도가 송신자의 전송 속도를 따라잡을 수 없어서  
패킷 손실이 일어날 수 있기 때문에 송신자의 전송 속도를 강제로 느리게 하는 기능  

혼잡제어가 일어나는 경우
* 2개의 송신자와 무한 버퍼를 갖는 하나의 라우터
* 2개의 송신자와 유한 버퍼를 가진 하나의 라우터
* 4개의 송신자와 유한 버퍼를 가지는 라우터, 그리고 멀티홉 경로  

혼잡제어에 대한 접근법
* 종단간의 혼잡제어
* 네트워크 지원 혼잡제어


#### 예상 질문
* TCP와 UDP의 차이점에 대해 설명해주세요.
* 3 Way-HandShake와 4 Way-HandShak에 대해 설명해주세요.
* 패킷이란 무엇인가요?


### 참고
[쉽게 이해하는 네트워크 16. TCP/IP 전송 계층(트랜스포트 계층)과 포트(Port) 번호](https://better-together.tistory.com/134)
[트랜스포트 계층](https://velog.io/@cokkum113/%ED%8A%B8%EB%9E%9C%EC%8A%A4%ED%8F%AC%ED%8A%B8-%EA%B3%84%EC%B8%B5)  
[트랜스포트 계층의 역할](https://velog.io/@rkolx/%ED%8A%B8%EB%9E%9C%EC%8A%A4%ED%8F%AC%ED%8A%B8-%EA%B3%84%EC%B8%B5%EC%9D%98-%EC%97%AD%ED%95%A0)    
[4. 트랜스포트 계층](https://hello70825.tistory.com/458)  
[[네트워크] 트랜스포트 계층](https://ddb8036631.github.io/nw/%ED%8A%B8%EB%9E%9C%EC%8A%A4%ED%8F%AC%ED%8A%B8-%EA%B3%84%EC%B8%B5/#%EC%8B%A0%EB%A2%B0%EC%A0%81%EC%9D%B8-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%A0%84%EB%8B%AC)